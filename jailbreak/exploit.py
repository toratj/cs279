import angr, monkeyhex,sys

argv = sys.argv[1:]

p = angr.Project('jailbreak')
state = 0
if len(sys.argv) > 1:
    state = p.factory.entry_state(args=sys.argv)
else:
    state = p.factory.entry_state()
sm = p.factory.simulation_manager(state)
sm.run()
for i in range(0,len(sm.deadended)):
    noError = True
    index = 0
    while(noError):
        try:
            print(sm.deadended[i].posix.dumps(index))
            index = index + 1
        except AttributeError as e:
            noError = False
